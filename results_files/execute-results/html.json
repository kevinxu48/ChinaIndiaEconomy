{
  "hash": "605e3a7284026d5b4ddb90a1b623dbf5",
  "result": {
    "markdown": "# Results\n\n### Temporary Headings. Replace with something meaningful that summarizes the plots we create\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#packages and helper functions \nlibrary(maps)\nlibrary(mapproj)\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: viridisLite\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'viridis'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:maps':\n\n    unemp\n```\n:::\n\n```{.r .cell-code}\nlibrary(gridExtra)\nlibrary(ggthemes)\nlibrary(tidyr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ purrr     1.0.2\n✔ forcats   1.0.0     ✔ readr     2.1.4\n✔ ggplot2   3.4.4     ✔ stringr   1.5.1\n✔ lubridate 1.9.3     ✔ tibble    3.2.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::combine() masks gridExtra::combine()\n✖ dplyr::filter()  masks stats::filter()\n✖ dplyr::lag()     masks stats::lag()\n✖ purrr::map()     masks maps::map()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'scales'\n\nThe following object is masked from 'package:purrr':\n\n    discard\n\nThe following object is masked from 'package:readr':\n\n    col_factor\n\nThe following object is masked from 'package:viridis':\n\n    viridis_pal\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nkv_theme <- function (){\n  theme_minimal() %+replace%\n    theme(legend.title = element_blank(),\n          plot.title = element_text(\n            size = 12,\n            face = 'bold',\n            hjust = 0,\n            vjust = 0))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninflation <- read.csv(\"inflation.csv\", header = TRUE, check.names = FALSE)\ninflation <- pivot_longer(inflation, cols='1960':'2022', names_to = \"year\", values_to = \"inflation\") %>%\n  mutate(year = as.integer(year)) %>% filter(year >= 1989)\ninflation <- inflation %>%\n  arrange(year) %>%\n  group_by(`Country Name`) %>%\n  mutate(inf_change = (((inflation - lag(inflation)) /lag(inflation)) *100)) %>%\n  filter(`Country Name` %in% c(\"China\", \"India\")) %>% rename(Country = `Country Name`) %>%\n  select(Country, year, inf_change)\n\nunemp <- read.csv(\"unemployment.csv\", header = TRUE, check.names = FALSE)\nunemp <- pivot_longer(unemp, cols='1960':'2022', names_to = \"year\", values_to = \"unemployment\") %>%\n  mutate(year = as.integer(year)) %>% filter(year >= 1989)\nunemp <- unemp %>%\n  arrange(year) %>%\n  group_by(Country) %>%\n  mutate(unemp_change = (((unemployment - lag(unemployment)) /lag(unemployment)) *100)) %>%\n  filter(Country %in% c(\"China\", \"India\")) %>%\n  select(Country, year, unemp_change)\n\nGDP_growth <- read.csv(\"GDP_growth.csv\", header = TRUE, check.names = FALSE)\nGDP_growth <- pivot_longer(GDP_growth, cols='1960':'2022', names_to = \"year\", values_to = \"GDPgrowth\") %>%\n  mutate(year = as.integer(year), GDPgrowth = (GDPgrowth)) %>%\n  filter(year >= 1989) %>% rename(Country = `Country Name`) %>%\n  select(Country, year, GDPgrowth)\n\n#Year-over-year comparison of key economic factors\nyoy_comp <- GDP_growth %>%\n  merge(inflation, by = c(\"Country\", \"year\")) %>%\n  merge(unemp, by = c(\"Country\", \"year\")) %>%\n  mutate(Country = as.factor(Country)) %>% \n  rename(GDP = GDPgrowth, `Unemployment Rate` = unemp_change, Inflation = inf_change)\n\nyoy_comp <- pivot_longer(yoy_comp, cols='GDP':'Unemployment Rate', names_to = \"indicator\", values_to = \"value\")\n\nyoyc_China <- yoy_comp %>% filter(year >= 2019 & Country == \"China\") %>%\n  ggplot() +\n  geom_col(aes(x = year, y = value, fill = indicator), position = \"dodge\") +\n  scale_fill_brewer(palette = \"YlOrRd\") + \n  kv_theme() + \n  labs(x = \"\", y = \"(%)\", title = \"China\")\n\nyoyc_India <- yoy_comp %>% filter(year >= 2019 & Country == \"India\") %>%\n  ggplot() +\n  geom_col(aes(x = year, y = value, fill = indicator), position = \"dodge\") +\n  scale_fill_brewer(palette = \"YlGn\") + \n  kv_theme() + \n  labs(x = \"\", y = \"(%)\", title = \"India\")\n\ngrid.arrange(yoyc_China, yoyc_India, top = \"Year over year changes in key economic indicators\")\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## How have China and India's growth stories differed?\n\n::: {.cell}\n\n```{.r .cell-code}\nGDP_values = read.csv(\"GDP_values.csv\")\nGDP_vals = GDP_values[((GDP_values$`Country.Name` == 'China')| (GDP_values$`Country.Name` == 'India')), ]\nL = pivot_longer(GDP_vals,cols='X1960':'X2022', names_to = \"year\", values_to = \"GDP per Cap\")\nL$year<-gsub(\"X\",\"\",as.character(L$year))\nL$year <- as.integer(L$year)\n\n\nGDP_vals = L[c(\"Country.Name\", \"Indicator.Name\", \"year\", \"GDP per Cap\")]\nGDP_vals = GDP_vals %>% rename(Country = `Country.Name`)\n\nGDP_growth = read.csv(\"GDP.csv\")\nGDP_growth = GDP_growth[((GDP_growth$`Country.Name` == 'China')| (GDP_growth$`Country.Name` == 'India')) |  (GDP_growth$`Country.Name` == 'United States'), ]\nL = pivot_longer(GDP_growth,cols='X1961':'X2022', names_to = \"year\", values_to = \"GDP Growth %\")\n\nL$year<-gsub(\"X\",\"\",as.character(L$year))\nL$year <- as.integer(L$year)\n\nGDP_growth = L[c(\"Country.Name\", \"Indicator.Name\", \"year\", \"GDP Growth %\")]\nGDP_growth = GDP_growth %>% rename(Country = \"Country.Name\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(GDP_vals, aes(year,`GDP per Cap`)) +\n  geom_point(color = \"Black\") +\n  stat_smooth(method = \"loess\", se = FALSE, span = 0.5)+\n  facet_wrap(Country~.)+\n  ylab(\"GDP Per Capita (US$)\")+\n  xlab(\"Year\")+ \n  theme(axis.text.x = element_text(angle = 80, vjust=0.5))+\n  ggtitle(\"Historically China has Significantly Higher GDP Per Capita\")+ \n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-4-1.png){width=1440}\n:::\n:::\n\nGross domestic product (GDP) per capita is a metric that describes a country's economic output per person, so a high value indicates a stronger economy; GDP per capita is also a better measure for comparing overall economy than nominal GDP because it takes into account because it takes population size into account, which is especially important for China and India because they are the two most populous countries in the world. From this scatterplot with fitted line, we see that while both China and India have had growing GDP per capita levels since 1960, since 2000 China's has skyrocketed compared to India's. As of 2020, the difference between their GDP per Capita is over $10000. When looking at GDP growth without considering other factors, it appears that if current trends continue, it will take many years for India's GDP per Capita to surpass China's.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(GDP_growth, aes(year,Country, fill = `GDP Growth %`)) +\n  geom_tile(color = \"Black\") +\n   theme_minimal() +\n  theme(axis.text.x = element_text(angle = 80, vjust=0.5))+\n  ggtitle(\"China's GDP has Generally Grown Faster than India's since 1960\")+ \n  scale_fill_gradient2(\n    low = muted(\"orange\"),\n    mid = \"white\",\n    high = muted(\"green\"),\n    midpoint = 0\n  )+\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-5-1.png){width=1440}\n:::\n:::\n\nWe use the United States' GDP growth as a benchmark for comparison because it is considered the largest economy in the world because it has the highest nominal GDP out of any country.\n\n\n### What is the reasoning for these differences?\nParallel coordinates\n\n2 way bar chart with exports going one direction and imports going the other direction\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexports = read.csv(\"exports.csv\")\nimports = read.csv(\"imports.csv\")\n\nexports = exports[((exports$`Country.Name` == 'China')| (exports$`Country.Name` == 'India')), ]\nL = pivot_longer(exports,cols='X1961':'X2022', names_to = \"year\", values_to = \"Exports\")\n\nL$year<-gsub(\"X\",\"\",as.character(L$year))\nL$year <- as.integer(L$year)\n\nexports = L[c(\"Country.Name\", \"Indicator.Name\", \"year\", \"Exports\")]\nexports = exports %>% rename(Country = \"Country.Name\")\nexports$Exports = exports$Exports/(10**9)\nimports = imports[((imports$`Country.Name` == 'China')| (imports$`Country.Name` == 'India')), ]\nL = pivot_longer(imports,cols='X1961':'X2022', names_to = \"year\", values_to = \"Imports\")\n\nL$year<-gsub(\"X\",\"\",as.character(L$year))\nL$year <- as.integer(L$year)\n\nimports = L[c(\"Country.Name\", \"Indicator.Name\", \"year\", \"Imports\")]\nimports = imports %>% rename(Country = \"Country.Name\")\n# make imports negative value for plot\nimports$Imports = imports$Imports/(-10**9)\n\nimportexports = merge(exports,imports,by=c(\"Country\",\"year\"))\npivotimportexports = pivot_longer(importexports, cols=c(\"Exports\",\"Imports\"), names_to = \"type\",values_to = \"value\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pivotimportexports,aes(x=year,y=value,fill=type))+\n    geom_bar(stat=\"identity\")+\n    xlab(\"year\")+\n    ylab(\"Amount spent on Imports/Exports (Billion $USD)\")+\n    facet_wrap(Country~.,scales=\"free_y\")+\n  coord_flip()+ \n  scale_fill_manual(values = c(\"seagreen3\", \"red3\"))+\n  theme(axis.text.x = element_text(angle = 80, vjust=0.5))+\n  ggtitle(\"China has Significantly Higher Amounts Imported and Exported\")+ \n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n## How do their historical trends set them up for the future?\n\n## Why are China and India Succeptible to Environmental Impact?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# units of (quad Btu)\nchinaenergy = read.csv(\"chinaenergy.csv\")\nindiaenergy = read.csv(\"indiaenergy.csv\")\nenergy = rbind(chinaenergy,indiaenergy)\n\nenergy = pivot_longer(energy,cols='X1980':'X2021', names_to = \"Year\", values_to = \"Total Production\")\nenergy = pivot_wider(energy, names_from = Type,values_from = `Total Production`)\n\n  \nenergy = energy %>% mutate(coal = Coal/Production)%>% \n  mutate(`natural gas` = `Natural Gas`/Production)%>%\n  mutate(petroleum = `Petroleum and other liquids`/Production)%>% \n  mutate(renewable = `Nuclear, renewables, and other`/Production)\nenergy$Year<-gsub(\"X\",\"\",as.character(energy$Year))\nenergy$Year <- as.integer(energy$Year)\nenergy = pivot_longer(energy,cols='coal':'renewable', names_to = \"Energy Usage Proportions\", values_to = \"Percentages\")\nenergyrecent = energy[energy$Year >= 2010,]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolors = c(\"darkred\",\"yellow\",\"tan\",\"blue\")\n\nggplot(energyrecent, aes(x = `Country`, y= Percentages, fill = `Energy Usage Proportions`)) +\n  geom_bar(position=\"fill\", stat=\"identity\")+\n  facet_wrap(~Year)+\n  scale_fill_manual(values = colors) +\n  theme(legend.position = \"bottom\")+\n  theme_minimal()+\n   theme(axis.text.x = element_text(angle = 80, vjust=0.5))+\n  ggtitle(\"Renewable Energy Usage has not Significantly Increased for Either Country\")+ \n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-9-1.png){width=1920}\n:::\n:::\n\n\n## How do Climate-related Challenges Impact Economy?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nghg <- read.csv(\"historical_emissions.csv\", header = TRUE, check.names = FALSE)\nghg$`1990` <- as.numeric(ghg$`1990`)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\nghg$Country <- as.factor(ghg$Country)\nghg <- pivot_longer(ghg, cols='2020':'1990', names_to = \"year\", values_to = \"emissions\")\nworld <- map_data(\"world\") %>% filter(! long > 180)\nworld <- world %>% rename(Country = region) %>% mutate(Country = factor(Country))\ndiff <- setdiff(world$Country, ghg$Country)\n\nworld <- world %>% mutate(Country = recode(str_trim(Country),\n                                          \"USA\" = \"United States\", \"UK\" = \"United Kingdom\",\n                                          \"Turkey\" = \"Türkiye\", \"Trinidad\" = \"Trinidad and Tobago\"))\nghg_2019 <- ghg %>% filter(year == 2019)\nworld_ghg <- inner_join(world, ghg_2019, by = \"Country\")\n\nglobal_emit <- ggplot(data = world_ghg, mapping = aes(x = long, y = lat, group = group)) +\n  coord_fixed(1.3) +\n  geom_polygon(aes(fill = emissions)) +\n  scale_fill_viridis() +\n  ggtitle(\"Global greenhouse gas emissions in 2019 (metric tons)\") +\n  kv_theme() +\n  theme(axis.text = element_blank(),\n        axis.line = element_blank(),\n        axis.ticks = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.title = element_blank(),\n        plot.title = element_text(margin = margin(b = 20))) +\n  coord_map(\"moll\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCoordinate system already present. Adding new coordinate system, which will\nreplace the existing one.\n```\n:::\n\n```{.r .cell-code}\nglobal_emit\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngain <- read.csv(\"gain.csv\", header = TRUE, check.names = FALSE)\nghg <- read.csv(\"historical_emissions.csv\", header = TRUE, check.names = FALSE)\n\ngain <- pivot_longer(gain,cols='1995':'2021', names_to = \"year\", values_to = \"score\")\nghg$`1990` <- as.numeric(ghg$`1990`)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\nghg$Country <- as.factor(ghg$Country)\nghg <- pivot_longer(ghg, cols='2020':'1990', names_to = \"year\", values_to = \"emissions\")\n\nghg_CI <- ghg %>% filter(Country %in% c(\"India\", \"China\"))\ngain_CI <- gain %>% filter(Name %in% c(\"India\", \"China\"))\n\ngain_CI$Name <- as.factor(gain_CI$Name)\ngain_CI$year <- as.integer(gain_CI$year)\ngain_CI <- gain_CI %>% mutate(Country = Name) %>% group_by(Country) %>% select(-Name)\n\nghg_CI$Country <- as.factor(ghg_CI$Country)\nghg_CI$year <- as.integer(ghg_CI$year)\nghg_CI <- ghg_CI %>% group_by(Country)\n\ncustom_colors <- c(\"China\" = \"red\", \"India\" = \"green4\")\nmerge1 <- merge(ghg_CI, gain_CI, by = c(\"year\", \"Country\")) %>%\n  select(year, Country, emissions, score) %>% \n  mutate(score = scale(score), emissions = scale(emissions))\n\nmerge1 <- pivot_longer(merge1,cols='emissions':'score', names_to = \"variable\", values_to = \"value\")\n\nmerge1 %>% group_by(Country, variable) %>%\n  ggplot() + geom_line(aes(x = year, y = value, color = Country, linetype = variable),linewidth = 1) +\n  scale_color_manual(values = custom_colors) +\n  kv_theme() + \n  labs(x = \"\", y = \"\", title = \"GHG emissions versus ND-Gain score over time\")\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngain_21 <- gain %>% filter(year >= 1995) %>% na.omit()\n\nquantiles <- quantile(gain_21$score, probs = c(0, 1/3, 2/3, 1))\ngain_21$score_cat <- cut(gain_21$score,\n                         breaks = quantiles,\n                         labels = c(\"Low\", \"Medium\", \"High\"))\n\n#gain_21 %>% filter(Name %in% G20) %>% \n#  ggplot(aes(year, Name, fill = score_cat)) + \n#    geom_tile(alpha = 0.95) + kv_theme() +\n#  scale_fill_manual(values=c('#ffffd4','#fe9929','#993404')) + \n#  scale_x_continuous(breaks = seq(min(gain_21$year), max(gain_21$year), by = 2)) +   labs(x = \"\", y = \"\", title = \"ND-Gain index scores over time - G20 countries\") +  theme(plot.title = element_text(margin = margin(b = 10)))\n```\n:::\n\n\n    Maybe do a mosaic plot with 2 splits: CO2 emissions and economic policies vs GDP per capita\n    \n    \nBar chart with imports going i\n",
    "supporting": [
      "results_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}